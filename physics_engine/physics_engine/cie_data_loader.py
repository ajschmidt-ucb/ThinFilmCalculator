import numpy as np

# --- Standard CIE 1931 2-degree CMFs Data (from getCIE1931CMFData.m) ---
# The CMFs are standardized on a 1 nm step from 380 nm to 780 nm (401 points).

def get_cie_1931_cmfs() -> tuple[np.ndarray, np.ndarray, np.ndarray, np.ndarray]:
    """Returns the lambda, x_bar, y_bar, and z_bar for CIE 1931 CMFs (380-780nm, 1nm step)."""
    
    # 401x1 Wavelength vector
    lambda_cmf = np.arange(380, 781, 1, dtype=np.float64) 
    
    # --- IMPORTANT: PASTE YOUR CIE 1931 CMF DATA HERE ---
    # The cmf_data array must be a 401x3 NumPy array.
    # It must contain all 401 rows from the 'cmf_data = [...]' section 
    # of your MATLAB file getCIE1931CMFData.m.
    # Columns: [x_bar, y_bar, z_bar]
    
    # This data is critical for accurate colorimetry.
    cmf_data_full = np.array([
    # nm | x_bar | y_bar | z_bar
    [0.00136800, 0.00003900, 0.00645000], #380nm
    [0.00150205, 0.00004283, 0.00708322], #381nm
    [0.00164233, 0.00004691, 0.00774549], #382nm
    [0.00180238, 0.00005159, 0.00850115], #383nm
    [0.00199576, 0.00005718, 0.00941454], #384nm
    [0.00223600, 0.00006400, 0.01055000], #385nm
    [0.00253538, 0.00007234, 0.01196580], #386nm
    [0.00289260, 0.00008221, 0.01365587], #387nm
    [0.00330083, 0.00009351, 0.01558805], #388nm
    [0.00375324, 0.00010614, 0.01773015], #389nm
    [0.00424300, 0.00012000, 0.02005001], #390nm
    [0.00476239, 0.00013498, 0.02251136], #391nm
    [0.00533005, 0.00015149, 0.02520288], #392nm
    [0.00597871, 0.00017021, 0.02827972], #393nm
    [0.00674112, 0.00019182, 0.03189704], #394nm
    [0.00765000, 0.00021700, 0.03621000], #395nm
    [0.00875137, 0.00024691, 0.04143771], #396nm
    [0.01002888, 0.00028124, 0.04750372], #397nm
    [0.01142170, 0.00031852, 0.05411988], #398nm
    [0.01286901, 0.00035727, 0.06099803], #399nm
    [0.01431000, 0.00039600, 0.06785001], #400nm
    [0.01570443, 0.00043372, 0.07448632], #401nm
    [0.01714744, 0.00047302, 0.08136156], #402nm
    [0.01878122, 0.00051788, 0.08915364], #403nm
    [0.02074801, 0.00057222, 0.09854048], #404nm
    [0.02319000, 0.00064000, 0.11020000], #405nm
    [0.02620736, 0.00072456, 0.12461330], #406nm
    [0.02978248, 0.00082550, 0.14170170], #407nm
    [0.03388092, 0.00094116, 0.16130350], #408nm
    [0.03846824, 0.00106988, 0.18325680], #409nm
    [0.04351000, 0.00121000, 0.20740000], #410nm
    [0.04899560, 0.00136209, 0.23369210], #411nm
    [0.05502260, 0.00153075, 0.26261140], #412nm
    [0.06171880, 0.00172037, 0.29477460], #413nm
    [0.06921200, 0.00193532, 0.33079850], #414nm
    [0.07763000, 0.00218000, 0.37130000], #415nm
    [0.08695811, 0.00245480, 0.41620910], #416nm
    [0.09717672, 0.00276400, 0.46546420], #417nm
    [0.10840630, 0.00311780, 0.51969480], #418nm
    [0.12076720, 0.00352640, 0.57953030], #419nm
    [0.13438000, 0.00400000, 0.64560000], #420nm
    [0.14935820, 0.00454624, 0.71848380], #421nm
    [0.16539570, 0.00515932, 0.79671330], #422nm
    [0.18198310, 0.00582928, 0.87784590], #423nm
    [0.19861100, 0.00654616, 0.95943900], #424nm
    [0.21477000, 0.00730000, 1.03905010], #425nm
    [0.23018680, 0.00808651, 1.11536730], #426nm
    [0.24487970, 0.00890872, 1.18849710], #427nm
    [0.25877730, 0.00976768, 1.25812330], #428nm
    [0.27180790, 0.01066443, 1.32392960], #429nm
    [0.28390000, 0.01160000, 1.38560000], #430nm
    [0.29494380, 0.01257317, 1.44263520], #431nm
    [0.30489650, 0.01358272, 1.49480350], #432nm
    [0.31378730, 0.01462968, 1.54219030], #433nm
    [0.32164540, 0.01571509, 1.58488070], #434nm
    [0.32850000, 0.01684000, 1.62296000], #435nm
    [0.33435130, 0.01800736, 1.65640480], #436nm
    [0.33921010, 0.01921448, 1.68529590], #437nm
    [0.34312130, 0.02045392, 1.70987450], #438nm
    [0.34612960, 0.02171824, 1.73038210], #439nm
    [0.34828000, 0.02300000, 1.74706000], #440nm
    [0.34959990, 0.02429461, 1.76004460], #441nm
    [0.35014740, 0.02561024, 1.76962330], #442nm
    [0.35001300, 0.02695857, 1.77626370], #443nm
    [0.34928700, 0.02835125, 1.78043340], #444nm
    [0.34806000, 0.02980000, 1.78260000], #445nm
    [0.34637330, 0.03131083, 1.78296820], #446nm
    [0.34426240, 0.03288368, 1.78169980], #447nm
    [0.34180880, 0.03452112, 1.77919820], #448nm
    [0.33909410, 0.03622571, 1.77586710], #449nm
    [0.33620000, 0.03800000, 1.77211000], #450nm
    [0.33319770, 0.03984667, 1.76825890], #451nm
    [0.33004110, 0.04176800, 1.76403900], #452nm
    [0.32663570, 0.04376600, 1.75894380], #453nm
    [0.32288680, 0.04584267, 1.75246630], #454nm
    [0.31870000, 0.04800000, 1.74410000], #455nm
    [0.31402510, 0.05024368, 1.73355950], #456nm
    [0.30888400, 0.05257304, 1.72085810], #457nm
    [0.30329040, 0.05498056, 1.70593690], #458nm
    [0.29725790, 0.05745872, 1.68873720], #459nm
    [0.29080000, 0.06000000, 1.66920000], #460nm
    [0.28397010, 0.06260197, 1.64752870], #461nm
    [0.27672140, 0.06527752, 1.62341270], #462nm
    [0.26891780, 0.06804208, 1.59602230], #463nm
    [0.26042270, 0.07091109, 1.56452800], #464nm
    [0.25110000, 0.07390000, 1.52810000], #465nm
    [0.24084750, 0.07701600, 1.48611140], #466nm
    [0.22985120, 0.08026640, 1.43952150], #467nm
    [0.21840720, 0.08366680, 1.38987990], #468nm
    [0.20681150, 0.08723280, 1.33873620], #469nm
    [0.19536000, 0.09098000, 1.28764000], #470nm
    [0.18421360, 0.09491755, 1.23742230], #471nm
    [0.17332730, 0.09904584, 1.18782430], #472nm
    [0.16268810, 0.10336740, 1.13876110], #473nm
    [0.15228330, 0.10788460, 1.09014800], #474nm
    [0.14210000, 0.11260000, 1.04190000], #475nm
    [0.13217860, 0.11753200, 0.99419760], #476nm
    [0.12256960, 0.12267440, 0.94734730], #477nm
    [0.11327520, 0.12799280, 0.90145310], #478nm
    [0.10429790, 0.13345280, 0.85661930], #479nm
    [0.09564000, 0.13902000, 0.81295010], #480nm
    [0.08729955, 0.14467640, 0.77051730], #481nm
    [0.07930804, 0.15046930, 0.72944480], #482nm
    [0.07171776, 0.15646190, 0.68991360], #483nm
    [0.06458099, 0.16271770, 0.65210490], #484nm
    [0.05795001, 0.16930000, 0.61620000], #485nm
    [0.05186211, 0.17624310, 0.58232860], #486nm
    [0.04628152, 0.18355810, 0.55041620], #487nm
    [0.04115088, 0.19127350, 0.52033760], #488nm
    [0.03641283, 0.19941800, 0.49196730], #489nm
    [0.03201000, 0.20802000, 0.46518000], #490nm
    [0.02791720, 0.21711990, 0.43992460], #491nm
    [0.02414440, 0.22673450, 0.41618360], #492nm
    [0.02068700, 0.23685710, 0.39388220], #493nm
    [0.01754040, 0.24748120, 0.37294590], #494nm
    [0.01470000, 0.25860000, 0.35330000], #495nm
    [0.01216179, 0.27018490, 0.33485780], #496nm
    [0.00991996, 0.28229390, 0.31755210], #497nm
    [0.00796724, 0.29505050, 0.30133750], #498nm
    [0.00629635, 0.30857800, 0.28616860], #499nm
    [0.00490000, 0.32300000, 0.27200000], #500nm
    [0.00377717, 0.33840210, 0.25881710], #501nm
    [0.00294532, 0.35468580, 0.24648380], #502nm
    [0.00242488, 0.37169860, 0.23477180], #503nm
    [0.00223629, 0.38928750, 0.22345330], #504nm
    [0.00240000, 0.40730000, 0.21230000], #505nm
    [0.00292552, 0.42562990, 0.20116920], #506nm
    [0.00383656, 0.44430960, 0.19011960], #507nm
    [0.00517484, 0.46339440, 0.17922540], #508nm
    [0.00698208, 0.48293950, 0.16856080], #509nm
    [0.00930000, 0.50300000, 0.15820000], #510nm
    [0.01214949, 0.52356930, 0.14813830], #511nm
    [0.01553588, 0.54451200, 0.13837580], #512nm
    [0.01947752, 0.56569000, 0.12899420], #513nm
    [0.02399277, 0.58696530, 0.12007510], #514nm
    [0.02910000, 0.60820000, 0.11170000], #515nm
    [0.03481485, 0.62934560, 0.10390480], #516nm
    [0.04112016, 0.65030680, 0.09666748], #517nm
    [0.04798504, 0.67087520, 0.08998272], #518nm
    [0.05537861, 0.69084240, 0.08384531], #519nm
    [0.06327000, 0.71000000, 0.07825000], #520nm
    [0.07163501, 0.72818520, 0.07320899], #521nm
    [0.08046224, 0.74546360, 0.06867816], #522nm
    [0.08973996, 0.76196940, 0.06456784], #523nm
    [0.09945645, 0.77783680, 0.06078835], #524nm
    [0.10960000, 0.79320000, 0.05725001], #525nm
    [0.12016740, 0.80811040, 0.05390435], #526nm
    [0.13111450, 0.82249620, 0.05074664], #527nm
    [0.14236790, 0.83630680, 0.04775276], #528nm
    [0.15385420, 0.84949160, 0.04489859], #529nm
    [0.16550000, 0.86200000, 0.04216000], #530nm
    [0.17725710, 0.87381080, 0.03950728], #531nm
    [0.18914000, 0.88496240, 0.03693564], #532nm
    [0.20116940, 0.89549360, 0.03445836], #533nm
    [0.21336580, 0.90544320, 0.03208872], #534nm
    [0.22574990, 0.91485010, 0.02984000], #535nm
    [0.23832090, 0.92373480, 0.02771181], #536nm
    [0.25106680, 0.93209240, 0.02569444], #537nm
    [0.26399220, 0.93992260, 0.02378716], #538nm
    [0.27710170, 0.94722520, 0.02198925], #539nm
    [0.29040000, 0.95400000, 0.02030000], #540nm
    [0.30389120, 0.96025610, 0.01871805], #541nm
    [0.31757260, 0.96600740, 0.01724036], #542nm
    [0.33143840, 0.97126060, 0.01586364], #543nm
    [0.34548280, 0.97602250, 0.01458461], #544nm
    [0.35970000, 0.98030000, 0.01340000], #545nm
    [0.37408390, 0.98409240, 0.01230723], #546nm
    [0.38863960, 0.98741820, 0.01130188], #547nm
    [0.40337840, 0.99031280, 0.01037792], #548nm
    [0.41831150, 0.99281160, 0.00952931], #549nm
    [0.43344990, 0.99495010, 0.00875000], #550nm
    [0.44879530, 0.99671080, 0.00803520], #551nm
    [0.46433600, 0.99809830, 0.00738160], #552nm
    [0.48006400, 0.99911200, 0.00678540], #553nm
    [0.49597130, 0.99974820, 0.00624280], #554nm
    [0.51205010, 1.00000000, 0.00575000], #555nm
    [0.52829590, 0.99985670, 0.00530360], #556nm
    [0.54469160, 0.99930460, 0.00489980], #557nm
    [0.56120940, 0.99832550, 0.00453420], #558nm
    [0.57782150, 0.99689870, 0.00420240], #559nm
    [0.59450000, 0.99500000, 0.00390000], #560nm
    [0.61122090, 0.99260050, 0.00362320], #561nm
    [0.62797580, 0.98974260, 0.00337060], #562nm
    [0.64476020, 0.98644440, 0.00314140], #563nm
    [0.66156970, 0.98272410, 0.00293480], #564nm
    [0.67840000, 0.97860000, 0.00275000], #565nm
    [0.69523920, 0.97408370, 0.00258520], #566nm
    [0.71205860, 0.96917120, 0.00243860], #567nm
    [0.72882840, 0.96385680, 0.00230940], #568nm
    [0.74551880, 0.95813490, 0.00219680], #569nm
    [0.76210000, 0.95200000, 0.00210000], #570nm
    [0.77854320, 0.94545040, 0.00201773], #571nm
    [0.79482560, 0.93849920, 0.00194820], #572nm
    [0.81092640, 0.93116280, 0.00188980], #573nm
    [0.82682480, 0.92345760, 0.00184093], #574nm
    [0.84250000, 0.91540000, 0.00180000], #575nm
    [0.85793250, 0.90700640, 0.00176627], #576nm
    [0.87308160, 0.89827720, 0.00173780], #577nm
    [0.88789440, 0.88920480, 0.00171120], #578nm
    [0.90231810, 0.87978160, 0.00168307], #579nm
    [0.91630000, 0.87000000, 0.00165000], #580nm
    [0.92979950, 0.85986130, 0.00161013], #581nm
    [0.94279840, 0.84939200, 0.00156440], #582nm
    [0.95527760, 0.83862200, 0.00151360], #583nm
    [0.96721790, 0.82758130, 0.00145853], #584nm
    [0.97860000, 0.81630000, 0.00140000], #585nm
    [0.98938560, 0.80479470, 0.00133667], #586nm
    [0.99954880, 0.79308200, 0.00127000], #587nm
    [1.00908920, 0.78119200, 0.00120500], #588nm
    [1.01800640, 0.76915470, 0.00114667], #589nm
    [1.02630000, 0.75700000, 0.00110000], #590nm
    [1.03398270, 0.74475410, 0.00106880], #591nm
    [1.04098600, 0.73242240, 0.00104940], #592nm
    [1.04718800, 0.72000360, 0.00103560], #593nm
    [1.05246670, 0.70749650, 0.00102120], #594nm
    [1.05670000, 0.69490000, 0.00100000], #595nm
    [1.05979440, 0.68221920, 0.00096864], #596nm
    [1.06179920, 0.66947160, 0.00092992], #597nm
    [1.06280680, 0.65667440, 0.00088688], #598nm
    [1.06290960, 0.64384480, 0.00084256], #599nm
    [1.06220000, 0.63100000, 0.00080000], #600nm
    [1.06073520, 0.61815550, 0.00076096], #601nm
    [1.05844360, 0.60531440, 0.00072368], #602nm
    [1.05522440, 0.59247560, 0.00068592], #603nm
    [1.05097680, 0.57963790, 0.00064544], #604nm
    [1.04560000, 0.56680000, 0.00060000], #605nm
    [1.03903690, 0.55396110, 0.00054787], #606nm
    [1.03136080, 0.54113720, 0.00049160], #607nm
    [1.02266620, 0.52835280, 0.00043540], #608nm
    [1.01304770, 0.51563230, 0.00038347], #609nm
    [1.00260000, 0.50300000, 0.00034000], #610nm
    [0.99136750, 0.49046880, 0.00030725], #611nm
    [0.97933140, 0.47803040, 0.00028316], #612nm
    [0.96649160, 0.46567760, 0.00026544], #613nm
    [0.95284790, 0.45340320, 0.00025181], #614nm
    [0.93840000, 0.44120000, 0.00024000], #615nm
    [0.92319400, 0.42908000, 0.00022955], #616nm
    [0.90724400, 0.41703600, 0.00022064], #617nm
    [0.89050200, 0.40503200, 0.00021196], #618nm
    [0.87292000, 0.39303200, 0.00020219], #619nm
    [0.85444990, 0.38100000, 0.00019000], #620nm
    [0.83508400, 0.36891840, 0.00017421], #621nm
    [0.81494600, 0.35682720, 0.00015564], #622nm
    [0.79418600, 0.34477680, 0.00013596], #623nm
    [0.77295400, 0.33281760, 0.00011685], #624nm
    [0.75140000, 0.32100000, 0.00010000], #625nm
    [0.72958360, 0.30933810, 0.00008613], #626nm
    [0.70758880, 0.29785040, 0.00007460], #627nm
    [0.68560220, 0.28659360, 0.00006500], #628nm
    [0.66381040, 0.27562450, 0.00005693], #629nm
    [0.64240000, 0.26500000, 0.00005000], #630nm
    [0.62151490, 0.25476320, 0.00004416], #631nm
    [0.60111380, 0.24488960, 0.00003948], #632nm
    [0.58110520, 0.23533440, 0.00003572], #633nm
    [0.56139770, 0.22605280, 0.00003264], #634nm
    [0.54190000, 0.21700000, 0.00003000], #635nm
    [0.52259950, 0.20816160, 0.00002765], #636nm
    [0.50354640, 0.19954880, 0.00002556], #637nm
    [0.48474360, 0.19115520, 0.00002364], #638nm
    [0.46619390, 0.18297440, 0.00002181], #639nm
    [0.44790000, 0.17500000, 0.00002000], #640nm
    [0.42986130, 0.16722350, 0.00001813], #641nm
    [0.41209800, 0.15964640, 0.00001620], #642nm
    [0.39464400, 0.15227760, 0.00001420], #643nm
    [0.37753330, 0.14512590, 0.00001213], #644nm
    [0.36080000, 0.13820000, 0.00001000], #645nm
    [0.34445630, 0.13150030, 0.00000773], #646nm
    [0.32851680, 0.12502480, 0.00000540], #647nm
    [0.31301920, 0.11877920, 0.00000320], #648nm
    [0.29800110, 0.11276910, 0.00000133], #649nm
    [0.28350000, 0.10700000, 0], #650nm
    [0.26954480, 0.10147620, 0], #651nm
    [0.25611840, 0.09618864, 0], #652nm
    [0.24318960, 0.09112296, 0], #653nm
    [0.23072720, 0.08626485, 0], #654nm
    [0.21870000, 0.08160000, 0], #655nm
    [0.20709710, 0.07712064, 0], #656nm
    [0.19592320, 0.07282552, 0], #657nm
    [0.18517080, 0.06871008, 0], #658nm
    [0.17483230, 0.06476976, 0], #659nm
    [0.16490000, 0.06100000, 0], #660nm
    [0.15536670, 0.05739621, 0], #661nm
    [0.14623000, 0.05395504, 0], #662nm
    [0.13749000, 0.05067376, 0], #663nm
    [0.12914670, 0.04754965, 0], #664nm
    [0.12120000, 0.04458000, 0], #665nm
    [0.11363970, 0.04175872, 0], #666nm
    [0.10646500, 0.03908496, 0], #667nm
    [0.09969044, 0.03656384, 0], #668nm
    [0.09333061, 0.03420048, 0], #669nm
    [0.08740000, 0.03200000, 0], #670nm
    [0.08190096, 0.02996261, 0], #671nm
    [0.07680428, 0.02807664, 0], #672nm
    [0.07207712, 0.02632936, 0], #673nm
    [0.06768664, 0.02470805, 0], #674nm
    [0.06360000, 0.02320000, 0], #675nm
    [0.05980685, 0.02180077, 0], #676nm
    [0.05628216, 0.02050112, 0], #677nm
    [0.05297104, 0.01928108, 0], #678nm
    [0.04981861, 0.01812069, 0], #679nm
    [0.04677000, 0.01700000, 0], #680nm
    [0.04378405, 0.01590379, 0], #681nm
    [0.04087536, 0.01483718, 0], #682nm
    [0.03807264, 0.01381068, 0], #683nm
    [0.03540461, 0.01283478, 0], #684nm
    [0.03290000, 0.01192000, 0], #685nm
    [0.03056419, 0.01106831, 0], #686nm
    [0.02838056, 0.01027339, 0], #687nm
    [0.02634484, 0.00953331, 0], #688nm
    [0.02445275, 0.00884616, 0], #689nm
    [0.02270000, 0.00821000, 0], #690nm
    [0.02108429, 0.00762378, 0], #691nm
    [0.01959988, 0.00708542, 0], #692nm
    [0.01823732, 0.00659148, 0], #693nm
    [0.01698717, 0.00613848, 0], #694nm
    [0.01584000, 0.00572300, 0], #695nm
    [0.01479064, 0.00534306, 0], #696nm
    [0.01383132, 0.00499580, 0], #697nm
    [0.01294868, 0.00467640, 0], #698nm
    [0.01212920, 0.00438008, 0], #699nm
    [0.01135916, 0.00410200, 0], #700nm
    [0.01062935, 0.00383845, 0], #701nm
    [0.00993885, 0.00358910, 0], #702nm
    [0.00928842, 0.00335422, 0], #703nm
    [0.00867885, 0.00313409, 0], #704nm
    [0.00811092, 0.00292900, 0], #705nm
    [0.00758239, 0.00273814, 0], #706nm
    [0.00708875, 0.00255988, 0], #707nm
    [0.00662731, 0.00239324, 0], #708nm
    [0.00619541, 0.00223728, 0], #709nm
    [0.00579035, 0.00209100, 0], #710nm
    [0.00540983, 0.00195359, 0], #711nm
    [0.00505258, 0.00182458, 0], #712nm
    [0.00471751, 0.00170358, 0], #713nm
    [0.00440351, 0.00159019, 0], #714nm
    [0.00410946, 0.00148400, 0], #715nm
    [0.00383391, 0.00138450, 0], #716nm
    [0.00357575, 0.00129127, 0], #717nm
    [0.00333434, 0.00120409, 0], #718nm
    [0.00310908, 0.00112274, 0], #719nm
    [0.00289933, 0.00104700, 0], #720nm
    [0.00270435, 0.00097659, 0], #721nm
    [0.00252302, 0.00091111, 0], #722nm
    [0.00235417, 0.00085013, 0], #723nm
    [0.00219662, 0.00079324, 0], #724nm
    [0.00204919, 0.00074000, 0], #725nm
    [0.00191096, 0.00069008, 0], #726nm
    [0.00178144, 0.00064331, 0], #727nm
    [0.00166011, 0.00059950, 0], #728nm
    [0.00154646, 0.00055846, 0], #729nm
    [0.00143997, 0.00052000, 0], #730nm
    [0.00134004, 0.00048391, 0], #731nm
    [0.00124627, 0.00045005, 0], #732nm
    [0.00115847, 0.00041835, 0], #733nm
    [0.00107643, 0.00038872, 0], #734nm
    [0.00099995, 0.00036110, 0], #735nm
    [0.00092874, 0.00033538, 0], #736nm
    [0.00086243, 0.00031144, 0], #737nm
    [0.00080075, 0.00028917, 0], #738nm
    [0.00074340, 0.00026845, 0], #739nm
    [0.00069008, 0.00024920, 0], #740nm
    [0.00064052, 0.00023130, 0], #741nm
    [0.00059450, 0.00021469, 0], #742nm
    [0.00055187, 0.00019929, 0], #743nm
    [0.00051243, 0.00018505, 0], #744nm
    [0.00047602, 0.00017190, 0], #745nm
    [0.00044245, 0.00015978, 0], #746nm
    [0.00041151, 0.00014860, 0], #747nm
    [0.00038298, 0.00013830, 0], #748nm
    [0.00035665, 0.00012879, 0], #749nm
    [0.00033230, 0.00012000, 0], #750nm
    [0.00030976, 0.00011186, 0], #751nm
    [0.00028889, 0.00010432, 0], #752nm
    [0.00026954, 0.00009734, 0], #753nm
    [0.00025157, 0.00009085, 0], #754nm
    [0.00023483, 0.00008480, 0], #755nm
    [0.00021917, 0.00007915, 0], #756nm
    [0.00020453, 0.00007386, 0], #757nm
    [0.00019084, 0.00006892, 0], #758nm
    [0.00017807, 0.00006430, 0], #759nm
    [0.00016615, 0.00006000, 0], #760nm
    [0.00015502, 0.00005598, 0], #761nm
    [0.00014462, 0.00005223, 0], #762nm
    [0.00013491, 0.00004872, 0], #763nm
    [0.00012585, 0.00004545, 0], #764nm
    [0.00011741, 0.00004240, 0], #765nm
    [0.00010955, 0.00003956, 0], #766nm
    [0.00010222, 0.00003692, 0], #767nm
    [0.00009539, 0.00003445, 0], #768nm
    [0.00008902, 0.00003215, 0], #769nm
    [0.00008308, 0.00003000, 0], #770nm
    [0.00007751, 0.00002799, 0], #771nm
    [0.00007231, 0.00002611, 0], #772nm
    [0.00006746, 0.00002436, 0], #773nm
    [0.00006293, 0.00002272, 0], #774nm
    [0.00005871, 0.00002120, 0], #775nm
    [0.00005477, 0.00001978, 0], #776nm
    [0.00005110, 0.00001845, 0], #777nm
    [0.00004768, 0.00001722, 0], #778nm
    [0.00004449, 0.00001606, 0], #779nm
    [0.00004151, 0.00001499, 0], #780nm
    ])

    if cmf_data_full.shape != (401, 3):
        # Fallback to zero-data structure to ensure the app launches
        cmf_data_full = np.zeros((401, 3)) 
    
    # Split the columns as required by the Python calculation
    x_bar_std = cmf_data_full[:, 0]
    y_bar_std = cmf_data_full[:, 1]
    z_bar_std = cmf_data_full[:, 2]
    
    return lambda_cmf, x_bar_std, y_bar_std, z_bar_std

# In cie_data_loader.py

# --- Standard D65 Illuminant SPD Data (from illuminant.m) ---
# Wavelengths: 300 nm to 830 nm in 1 nm steps (531 points)

def get_d65_spd() -> tuple[np.ndarray, np.ndarray]:
    """
    Returns the lambda and SPD values for the D65 Standard Illuminant 
    (300-830nm, 1nm step), extracted from the full illuminant.m file.
    """
    
    # 531x2 matrix from the D65 case in illuminant.m, columns are [lambda, energy]
    d65_data_full = np.array([
        # nm | energy (Normalized to 100 at 560nm)
    [300, 0.0341],
    [301, 0.36014],
    [302, 0.68618],
    [303, 1.01222],
    [304, 1.33826],
    [305, 1.6643],
    [306, 1.99034],
    [307, 2.31638],
    [308, 2.64242],
    [309, 2.96846],
    [310, 3.2945],
    [311, 4.98865],
    [312, 6.6828],
    [313, 8.37695],
    [314, 10.0711],
    [315, 11.7652],
    [316, 13.4594],
    [317, 15.1535],
    [318, 16.8477],
    [319, 18.5418],
    [320, 20.236],
    [321, 21.9177],
    [322, 23.5995],
    [323, 25.2812],
    [324, 26.963],
    [325, 28.6447],
    [326, 30.3265],
    [327, 32.0082],
    [328, 33.69],
    [329, 35.3717],
    [330, 37.0535],
    [331, 37.343],
    [332, 37.6326],
    [333, 37.9221],
    [334, 38.2116],
    [335, 38.5011],
    [336, 38.7907],
    [337, 39.0802],
    [338, 39.3697],
    [339, 39.6593],
    [340, 39.9488],
    [341, 40.4451],
    [342, 40.9414],
    [343, 41.4377],
    [344, 41.934],
    [345, 42.4302],
    [346, 42.9265],
    [347, 43.4228],
    [348, 43.9191],
    [349, 44.4154],
    [350, 44.9117],
    [351, 45.0844],
    [352, 45.257],
    [353, 45.4297],
    [354, 45.6023],
    [355, 45.775],
    [356, 45.9477],
    [357, 46.1203],
    [358, 46.293],
    [359, 46.4656],
    [360, 46.6383],
    [361, 47.1834],
    [362, 47.7285],
    [363, 48.2735],
    [364, 48.8186],
    [365, 49.3637],
    [366, 49.9088],
    [367, 50.4539],
    [368, 50.9989],
    [369, 51.544],
    [370, 52.0891],
    [371, 51.8777],
    [372, 51.6664],
    [373, 51.455],
    [374, 51.2437],
    [375, 51.0323],
    [376, 50.8209],
    [377, 50.6096],
    [378, 50.3982],
    [379, 50.1869],
    [380, 49.9755],
    [381, 50.4428],
    [382, 50.91],
    [383, 51.3773],
    [384, 51.8446],
    [385, 52.3118],
    [386, 52.7791],
    [387, 53.2464],
    [388, 53.7137],
    [389, 54.1809],
    [390, 54.6482],
    [391, 57.4589],
    [392, 60.2695],
    [393, 63.0802],
    [394, 65.8909],
    [395, 68.7015],
    [396, 71.5122],
    [397, 74.3229],
    [398, 77.1336],
    [399, 79.9442],
    [400, 82.7549],
    [401, 83.628],
    [402, 84.5011],
    [403, 85.3742],
    [404, 86.2473],
    [405, 87.1204],
    [406, 87.9936],
    [407, 88.8667],
    [408, 89.7398],
    [409, 90.6129],
    [410, 91.486],
    [411, 91.6806],
    [412, 91.8752],
    [413, 92.0697],
    [414, 92.2643],
    [415, 92.4589],
    [416, 92.6535],
    [417, 92.8481],
    [418, 93.0426],
    [419, 93.2372],
    [420, 93.4318],
    [421, 92.7568],
    [422, 92.0819],
    [423, 91.4069],
    [424, 90.732],
    [425, 90.057],
    [426, 89.3821],
    [427, 88.7071],
    [428, 88.0322],
    [429, 87.3572],
    [430, 86.6823],
    [431, 88.5006],
    [432, 90.3188],
    [433, 92.1371],
    [434, 93.9554],
    [435, 95.7736],
    [436, 97.5919],
    [437, 99.4102],
    [438, 101.228],
    [439, 103.047],
    [440, 104.865],
    [441, 106.079],
    [442, 107.294],
    [443, 108.508],
    [444, 109.722],
    [445, 110.936],
    [446, 112.151],
    [447, 113.365],
    [448, 114.579],
    [449, 115.794],
    [450, 117.008],
    [451, 117.088],
    [452, 117.169],
    [453, 117.249],
    [454, 117.33],
    [455, 117.41],
    [456, 117.49],
    [457, 117.571],
    [458, 117.651],
    [459, 117.732],
    [460, 117.812],
    [461, 117.517],
    [462, 117.222],
    [463, 116.927],
    [464, 116.632],
    [465, 116.336],
    [466, 116.041],
    [467, 115.746],
    [468, 115.451],
    [469, 115.156],
    [470, 114.861],
    [471, 114.967],
    [472, 115.073],
    [473, 115.18],
    [474, 115.286],
    [475, 115.392],
    [476, 115.498],
    [477, 115.604],
    [478, 115.711],
    [479, 115.817],
    [480, 115.923],
    [481, 115.212],
    [482, 114.501],
    [483, 113.789],
    [484, 113.078],
    [485, 112.367],
    [486, 111.656],
    [487, 110.945],
    [488, 110.233],
    [489, 109.522],
    [490, 108.811],
    [491, 108.865],
    [492, 108.92],
    [493, 108.974],
    [494, 109.028],
    [495, 109.082],
    [496, 109.137],
    [497, 109.191],
    [498, 109.245],
    [499, 109.3],
    [500, 109.354],
    [501, 109.199],
    [502, 109.044],
    [503, 108.888],
    [504, 108.733],
    [505, 108.578],
    [506, 108.423],
    [507, 108.268],
    [508, 108.112],
    [509, 107.957],
    [510, 107.802],
    [511, 107.501],
    [512, 107.2],
    [513, 106.898],
    [514, 106.597],
    [515, 106.296],
    [516, 105.995],
    [517, 105.694],
    [518, 105.392],
    [519, 105.091],
    [520, 104.79],
    [521, 105.08],
    [522, 105.37],
    [523, 105.66],
    [524, 105.95],
    [525, 106.239],
    [526, 106.529],
    [527, 106.819],
    [528, 107.109],
    [529, 107.399],
    [530, 107.689],
    [531, 107.361],
    [532, 107.032],
    [533, 106.704],
    [534, 106.375],
    [535, 106.047],
    [536, 105.719],
    [537, 105.39],
    [538, 105.062],
    [539, 104.733],
    [540, 104.405],
    [541, 104.369],
    [542, 104.333],
    [543, 104.297],
    [544, 104.261],
    [545, 104.225],
    [546, 104.19],
    [547, 104.154],
    [548, 104.118],
    [549, 104.082],
    [550, 104.046],
    [551, 103.641],
    [552, 103.237],
    [553, 102.832],
    [554, 102.428],
    [555, 102.023],
    [556, 101.618],
    [557, 101.214],
    [558, 100.809],
    [559, 100.405],
    [560, 100],
    [561, 99.6334],
    [562, 99.2668],
    [563, 98.9003],
    [564, 98.5337],
    [565, 98.1671],
    [566, 97.8005],
    [567, 97.4339],
    [568, 97.0674],
    [569, 96.7008],
    [570, 96.3342],
    [571, 96.2796],
    [572, 96.225],
    [573, 96.1703],
    [574, 96.1157],
    [575, 96.0611],
    [576, 96.0065],
    [577, 95.9519],
    [578, 95.8972],
    [579, 95.8426],
    [580, 95.788],
    [581, 95.0778],
    [582, 94.3675],
    [583, 93.6573],
    [584, 92.947],
    [585, 92.2368],
    [586, 91.5266],
    [587, 90.8163],
    [588, 90.1061],
    [589, 89.3958],
    [590, 88.6856],
    [591, 88.8177],
    [592, 88.9497],
    [593, 89.0818],
    [594, 89.2138],
    [595, 89.3459],
    [596, 89.478],
    [597, 89.61],
    [598, 89.7421],
    [599, 89.8741],
    [600, 90.0062],
    [601, 89.9655],
    [602, 89.9248],
    [603, 89.8841],
    [604, 89.8434],
    [605, 89.8026],
    [606, 89.7619],
    [607, 89.7212],
    [608, 89.6805],
    [609, 89.6398],
    [610, 89.5991],
    [611, 89.4091],
    [612, 89.219],
    [613, 89.029],
    [614, 88.8389],
    [615, 88.6489],
    [616, 88.4589],
    [617, 88.2688],
    [618, 88.0788],
    [619, 87.8887],
    [620, 87.6987],
    [621, 87.2577],
    [622, 86.8167],
    [623, 86.3757],
    [624, 85.9347],
    [625, 85.4936],
    [626, 85.0526],
    [627, 84.6116],
    [628, 84.1706],
    [629, 83.7296],
    [630, 83.2886],
    [631, 83.3297],
    [632, 83.3707],
    [633, 83.4118],
    [634, 83.4528],
    [635, 83.4939],
    [636, 83.535],
    [637, 83.576],
    [638, 83.6171],
    [639, 83.6581],
    [640, 83.6992],
    [641, 83.332],
    [642, 82.9647],
    [643, 82.5975],
    [644, 82.2302],
    [645, 81.863],
    [646, 81.4958],
    [647, 81.1285],
    [648, 80.7613],
    [649, 80.394],
    [650, 80.0268],
    [651, 80.0456],
    [652, 80.0644],
    [653, 80.0831],
    [654, 80.1019],
    [655, 80.1207],
    [656, 80.1395],
    [657, 80.1583],
    [658, 80.177],
    [659, 80.1958],
    [660, 80.2146],
    [661, 80.4209],
    [662, 80.6272],
    [663, 80.8336],
    [664, 81.0399],
    [665, 81.2462],
    [666, 81.4525],
    [667, 81.6588],
    [668, 81.8652],
    [669, 82.0715],
    [670, 82.2778],
    [671, 81.8784],
    [672, 81.4791],
    [673, 81.0797],
    [674, 80.6804],
    [675, 80.281],
    [676, 79.8816],
    [677, 79.4823],
    [678, 79.0829],
    [679, 78.6836],
    [680, 78.2842],
    [681, 77.4279],
    [682, 76.5716],
    [683, 75.7153],
    [684, 74.859],
    [685, 74.0027],
    [686, 73.1465],
    [687, 72.2902],
    [688, 71.4339],
    [689, 70.5776],
    [690, 69.7213],
    [691, 69.9101],
    [692, 70.0989],
    [693, 70.2876],
    [694, 70.4764],
    [695, 70.6652],
    [696, 70.854],
    [697, 71.0428],
    [698, 71.2315],
    [699, 71.4203],
    [700, 71.6091],
    [701, 71.8831],
    [702, 72.1571],
    [703, 72.4311],
    [704, 72.7051],
    [705, 72.979],
    [706, 73.253],
    [707, 73.527],
    [708, 73.801],
    [709, 74.075],
    [710, 74.349],
    [711, 73.0745],
    [712, 71.8],
    [713, 70.5255],
    [714, 69.251],
    [715, 67.9765],
    [716, 66.702],
    [717, 65.4275],
    [718, 64.153],
    [719, 62.8785],
    [720, 61.604],
    [721, 62.4322],
    [722, 63.2603],
    [723, 64.0885],
    [724, 64.9166],
    [725, 65.7448],
    [726, 66.573],
    [727, 67.4011],
    [728, 68.2293],
    [729, 69.0574],
    [730, 69.8856],
    [731, 70.4057],
    [732, 70.9259],
    [733, 71.446],
    [734, 71.9662],
    [735, 72.4863],
    [736, 73.0064],
    [737, 73.5266],
    [738, 74.0467],
    [739, 74.5669],
    [740, 75.087],
    [741, 73.9376],
    [742, 72.7881],
    [743, 71.6387],
    [744, 70.4893],
    [745, 69.3398],
    [746, 68.1904],
    [747, 67.041],
    [748, 65.8916],
    [749, 64.7421],
    [750, 63.5927],
    [751, 61.8752],
    [752, 60.1578],
    [753, 58.4403],
    [754, 56.7229],
    [755, 55.0054],
    [756, 53.288],
    [757, 51.5705],
    [758, 49.8531],
    [759, 48.1356],
    [760, 46.4182],
    [761, 48.4569],
    [762, 50.4956],
    [763, 52.5344],
    [764, 54.5731],
    [765, 56.6118],
    [766, 58.6505],
    [767, 60.6892],
    [768, 62.728],
    [769, 64.7667],
    [770, 66.8054],
    [771, 66.4631],
    [772, 66.1209],
    [773, 65.7786],
    [774, 65.4364],
    [775, 65.0941],
    [776, 64.7518],
    [777, 64.4096],
    [778, 64.0673],
    [779, 63.7251],
    [780, 63.3828],
    [781, 63.4749],
    [782, 63.567],
    [783, 63.6592],
    [784, 63.7513],
    [785, 63.8434],
    [786, 63.9355],
    [787, 64.0276],
    [788, 64.1198],
    [789, 64.2119],
    [790, 64.304],
    [791, 63.8188],
    [792, 63.3336],
    [793, 62.8484],
    [794, 62.3632],
    [795, 61.8779],
    [796, 61.3927],
    [797, 60.9075],
    [798, 60.4223],
    [799, 59.9371],
    [800, 59.4519],
    [801, 58.7026],
    [802, 57.9533],
    [803, 57.204],
    [804, 56.4547],
    [805, 55.7054],
    [806, 54.9562],
    [807, 54.2069],
    [808, 53.4576],
    [809, 52.7083],
    [810, 51.959],
    [811, 52.5072],
    [812, 53.0553],
    [813, 53.6035],
    [814, 54.1516],
    [815, 54.6998],
    [816, 55.248],
    [817, 55.7961],
    [818, 56.3443],
    [819, 56.8924],
    [820, 57.4406],
    [821, 57.7278],
    [822, 58.015],
    [823, 58.3022],
    [824, 58.5894],
    [825, 58.8765],
    [826, 59.1637],
    [827, 59.4509],
    [828, 59.7381],
    [829, 60.0253],
    [830, 60.3125],
    ])
    
    # Separate the columns
    lambda_d65 = d65_data_full[:, 0]
    spd_d65_std = d65_data_full[:, 1]
    
    return lambda_d65, spd_d65_std
